{"remainingRequest":"E:\\Work\\Java\\lbmmovie\\lbmmoviebackend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Work\\Java\\lbmmovie\\lbmmoviebackend\\src\\views\\film\\Poster.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\Work\\Java\\lbmmovie\\lbmmoviebackend\\src\\views\\film\\Poster.vue","mtime":1682848112068},{"path":"E:\\Work\\Java\\lbmmovie\\lbmmoviebackend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Work\\Java\\lbmmovie\\lbmmoviebackend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgY29uZmlnIGZyb20gIkAvY29uZmlnIjsNCmltcG9ydCB7QWRkUG9zdGVyLCBEZWxldGVBbGxQb3N0ZXIsIERlbGV0ZVBvc3RlckJ5SWQsIExpc3RBbGxQb3N0ZXIsIFVwZGF0ZVBvc3Rlcn0gZnJvbSAiQC9hcGkvZmlsbSI7DQoNCmV4cG9ydCBkZWZhdWx0IHsNCg0KICBtb3VudGVkKCkgew0KICAgIExpc3RBbGxQb3N0ZXIoKS50aGVuKHJlcyA9PiB7DQogICAgICB0aGlzLnBvc3Rlckxpc3QgPSByZXMuZGF0YQ0KICAgIH0pDQogIH0sDQoNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgaGVhZGVyOiB7DQogICAgICAgICJBdXRob3JpemF0aW9uIjogbG9jYWxTdG9yYWdlLmdldEl0ZW0oInRva2VuIikNCiAgICAgIH0sDQogICAgICBkaWFsb2dGb3JtVmlzaWJsZTogZmFsc2UsDQogICAgICB1cGxvYWRBY3Rpb246IGNvbmZpZy5BUElfVVJMICsgJy91cGxvYWQnLA0KICAgICAgdXBsb2FkUG9zdGVyOiB7DQogICAgICAgIHVybDogJycsDQogICAgICAgIHRpdGxlOiAnJywNCiAgICAgICAgc3RhdHVzOiAnJywNCiAgICAgICAgY3JlYXRlQXQ6ICcnLA0KICAgICAgfSwNCiAgICAgIHBvc3Rlckxpc3Q6IFtdLA0KICAgIH0NCiAgfSwNCg0KICBtZXRob2RzOiB7DQoNCiAgICBoYW5kbGVVcGxvYWRTdWNjZXNzKHJlcykgew0KICAgICAgdGhpcy51cGxvYWRQb3N0ZXIudXJsID0gcmVzDQogICAgfSwNCg0KICAgIHN1Ym1pdFVwbG9hZCgpIHsNCiAgICAgIEFkZFBvc3Rlcih0aGlzLnVwbG9hZFBvc3RlcikudGhlbihyZXMgPT4gew0KICAgICAgICBjb25zb2xlLmxvZyhyZXMpDQogICAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGUgPSBmYWxzZTsNCiAgICAgIH0pDQogICAgfSwNCg0KICAgIGRlbGV0ZUFsbFBvc3RlcigpIHsNCiAgICAgIERlbGV0ZUFsbFBvc3RlcigpLnRoZW4ocmVzID0+IHsNCiAgICAgICAgdGhpcy5wb3N0ZXJMaXN0ID0gbnVsbDsNCiAgICAgIH0pDQogICAgfSwNCg0KICAgIGNoYW5nZVBvc3RlclN0YXR1cyhpbmRleCwgcG9zdGVyLCBzdGF0dXMpIHsNCiAgICAgIHBvc3Rlci5zdGF0dXMgPSBzdGF0dXMNCiAgICAgIFVwZGF0ZVBvc3Rlcihwb3N0ZXIpLnRoZW4ocmVzID0+IHsNCiAgICAgICAgdGhpcy5wb3N0ZXJMaXN0W2luZGV4XS5zdGF0dXMgPSBzdGF0dXMNCiAgICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgICAgbWVzc2FnZTogJ+aIkOWKn+a2iOaBr++8muaTjeS9nOaIkOWKnycsDQogICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnDQogICAgICAgIH0pOw0KICAgICAgfSkNCiAgICB9LA0KDQogICAgaGFuZGxlRGVsZXRlUG9zdGVyKGluZGV4LCBpZCkgew0KICAgICAgRGVsZXRlUG9zdGVyQnlJZChpZCkudGhlbihyZXMgPT4gew0KICAgICAgICB0aGlzLnBvc3Rlckxpc3Quc3BsaWNlKGluZGV4LCAxKTsNCiAgICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgICAgbWVzc2FnZTogJ+aIkOWKn+a2iOaBr++8muWIoOmZpOaIkOWKnycsDQogICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnDQogICAgICAgIH0pOw0KICAgICAgfSkNCiAgICB9LA0KDQogIH0NCn0NCg=="},{"version":3,"sources":["Poster.vue"],"names":[],"mappings":";AAuHA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"Poster.vue","sourceRoot":"src/views/film","sourcesContent":["<template>\r\n  <div>\r\n    <el-carousel v-if=\"posterList.length !== 0\" height=\"500px\" indicator-position=\"outside\">\r\n      <el-carousel-item v-for=\"(item, index) in posterList\" :key=\"index\">\r\n        <img alt=\"\"\r\n             :src=\"item.url\"\r\n             class=\"image\">\r\n      </el-carousel-item>\r\n    </el-carousel>\r\n\r\n    <div class=\"content\">\r\n      <el-button\r\n          @click=\"dialogFormVisible = true\"\r\n          type=\"primary\"\r\n          icon=\"el-icon-upload\">\r\n        上传轮播海报\r\n      </el-button>\r\n      <el-button\r\n          style=\"margin-left: 10px\"\r\n          type=\"danger\"\r\n          icon=\"el-icon-delete\"\r\n          @click=\"deleteAllPoster\">\r\n        删除所有海报\r\n      </el-button>\r\n      <el-table\r\n          ref=\"filterTable\"\r\n          :data=\"posterList\"\r\n          style=\"width: 100%;margin-top: 15px;\">\r\n        <el-table-column\r\n            prop=\"createAt\"\r\n            label=\"上传时间\"\r\n            width=\"220\"\r\n        >\r\n        </el-table-column>\r\n        <el-table-column\r\n            prop=\"title\"\r\n            label=\"标题\"\r\n            width=\"180\">\r\n        </el-table-column>\r\n        <el-table-column label=\"地址预览\">\r\n          <template slot-scope=\"scope\">\r\n            <a target=\"_blank\" :href=\"scope.row.url\">{{ scope.row.url }}</a>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column\r\n            prop=\"status\"\r\n            label=\"上架状态\"\r\n            width=\"220\">\r\n          <template slot-scope=\"scope\">\r\n            <el-tag\r\n                v-if=\"scope.row.status\"\r\n                type=\"success\"\r\n                disable-transitions>上架\r\n            </el-tag>\r\n            <el-tag\r\n                v-else\r\n                type=\"warning\"\r\n                disable-transitions>下架\r\n            </el-tag>\r\n            <el-button v-if=\"!scope.row.status\"\r\n                       style=\"padding: 0 15px;color: #67C23A\"\r\n                       type=\"text\"\r\n                       @click=\"changePosterStatus(scope.$index, scope.row, true)\"\r\n                       icon=\"el-icon-upload2\">上架\r\n            </el-button>\r\n            <el-button v-else\r\n                       style=\"padding: 0 15px;color: #E6A23C\"\r\n                       type=\"text\"\r\n                       @click=\"changePosterStatus(scope.$index, scope.row, false)\"\r\n                       icon=\"el-icon-download\">下架\r\n            </el-button>\r\n            <template style=\"padding-left: 100px\">\r\n              <el-popconfirm @confirm=\"handleDeletePoster(scope.$index, scope.row.id)\" title=\"确定要删除这条内容吗？\">\r\n                <el-button slot=\"reference\"\r\n                           style=\"color: #F56C6C\" type=\"text\"\r\n                           icon=\"el-icon-delete\">删除\r\n                </el-button>\r\n              </el-popconfirm>\r\n            </template>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </div>\r\n\r\n    <el-dialog title=\"轮播海报\" :visible.sync=\"dialogFormVisible\">\r\n      <el-form :model=\"uploadPoster\">\r\n        <el-form-item label=\"海报标题\" style=\"margin-bottom: 35px\" label-width=\"120px\">\r\n          <el-input style=\"width: 360px\" v-model=\"uploadPoster.title\" autocomplete=\"off\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"上架状态\" style=\"margin-bottom: 35px\" label-width=\"120px\">\r\n          <el-select style=\"width: 360px\" v-model=\"uploadPoster.status\" placeholder=\"请选择活动区域\">\r\n            <el-option label=\"上架\" value=\"true\"></el-option>\r\n            <el-option label=\"下架\" value=\"false\"></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"选择图片\" label-width=\"120px\">\r\n          <el-upload\r\n              style=\"float: left\"\r\n              class=\"upload-demo\"\r\n              accept=\".png,.jpg\"\r\n              :headers=\"header\"\r\n              :action=\"uploadAction\"\r\n              :on-success=\"handleUploadSuccess\"\r\n              multiple\r\n              :limit=\"1\">\r\n            <el-button type=\"primary\" icon=\"el-icon-upload\">上传轮播海报</el-button>\r\n          </el-upload>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"submitUpload\">确 定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport config from \"@/config\";\r\nimport {AddPoster, DeleteAllPoster, DeletePosterById, ListAllPoster, UpdatePoster} from \"@/api/film\";\r\n\r\nexport default {\r\n\r\n  mounted() {\r\n    ListAllPoster().then(res => {\r\n      this.posterList = res.data\r\n    })\r\n  },\r\n\r\n  data() {\r\n    return {\r\n      header: {\r\n        \"Authorization\": localStorage.getItem(\"token\")\r\n      },\r\n      dialogFormVisible: false,\r\n      uploadAction: config.API_URL + '/upload',\r\n      uploadPoster: {\r\n        url: '',\r\n        title: '',\r\n        status: '',\r\n        createAt: '',\r\n      },\r\n      posterList: [],\r\n    }\r\n  },\r\n\r\n  methods: {\r\n\r\n    handleUploadSuccess(res) {\r\n      this.uploadPoster.url = res\r\n    },\r\n\r\n    submitUpload() {\r\n      AddPoster(this.uploadPoster).then(res => {\r\n        console.log(res)\r\n        this.dialogFormVisible = false;\r\n      })\r\n    },\r\n\r\n    deleteAllPoster() {\r\n      DeleteAllPoster().then(res => {\r\n        this.posterList = null;\r\n      })\r\n    },\r\n\r\n    changePosterStatus(index, poster, status) {\r\n      poster.status = status\r\n      UpdatePoster(poster).then(res => {\r\n        this.posterList[index].status = status\r\n        this.$message({\r\n          message: '成功消息：操作成功',\r\n          type: 'success'\r\n        });\r\n      })\r\n    },\r\n\r\n    handleDeletePoster(index, id) {\r\n      DeletePosterById(id).then(res => {\r\n        this.posterList.splice(index, 1);\r\n        this.$message({\r\n          message: '成功消息：删除成功',\r\n          type: 'success'\r\n        });\r\n      })\r\n    },\r\n\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n.content {\r\n  padding: 20px 40px;\r\n}\r\n\r\n.el-carousel__item h3 {\r\n  color: #475669;\r\n  font-size: 18px;\r\n  opacity: 0.75;\r\n  line-height: 300px;\r\n  margin: 0;\r\n}\r\n\r\n.image {\r\n  width: 100%;\r\n  height: 500px;\r\n}\r\n\r\n</style>"]}]}