{"remainingRequest":"E:\\Work\\Java\\Springboot-movie\\vue-app\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Work\\Java\\Springboot-movie\\vue-app\\src\\views\\me\\Cart.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\Work\\Java\\Springboot-movie\\vue-app\\src\\views\\me\\Cart.vue","mtime":1681576768463},{"path":"E:\\Work\\Java\\Springboot-movie\\vue-app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Work\\Java\\Springboot-movie\\vue-app\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQge0RlbGV0ZUNhcnRCeUlkLCBMaXN0Q2FydHN9IGZyb20gIkAvYXBpL2NhcnQiDQppbXBvcnQge0NyZWF0ZU9yZGVyfSBmcm9tICJAL2FwaS9vcmRlciI7DQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgaTogMCwNCiAgICAgIHN1Y2Nlc3M6IGZhbHNlLA0KICAgICAgY2VudGVyRGlhbG9nVmlzaWJsZTogZmFsc2UsDQogICAgICBsb2FkaW5nOiBmYWxzZSwNCiAgICAgIHByaWNlOiAwLA0KICAgICAgc2VsZWN0TGlzdDogW10sDQogICAgICBjaGVja0FsbDogZmFsc2UsDQogICAgICBjYXJ0TGlzdDogW10sDQogICAgICB1aWQ6IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ1aWQiKSwNCiAgICB9DQogIH0sDQoNCiAgbW91bnRlZCgpIHsNCiAgICB0aGlzLmxvYWRDYXJ0cygpDQogIH0sDQoNCiAgbWV0aG9kczogew0KDQogICAgbG9hZENhcnRzKCkgew0KICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsNCiAgICAgIExpc3RDYXJ0cyh0aGlzLnVpZCkudGhlbihyZXMgPT4gew0KICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICB0aGlzLmNhcnRMaXN0ID0gcmVzLmRhdGENCiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuY2FydExpc3QubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgIHRoaXMuc2VsZWN0TGlzdFtpXSA9IHtjaGVja2VkOiBmYWxzZSwgY2FydDogdGhpcy5jYXJ0TGlzdFtpXS5jYXJ0fQ0KICAgICAgICAgIH0NCiAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQ0KICAgICAgICB9LCA3MDApDQogICAgICB9KQ0KICAgIH0sDQoNCiAgICBoYW5kbGVDaGVjaygpIHsNCiAgICAgIHRoaXMuY2hlY2tPdXQoKQ0KICAgIH0sDQoNCiAgICBoYW5kbGVDaGVja0FsbCgpIHsNCiAgICAgIGlmICh0aGlzLmNoZWNrQWxsKSB7DQogICAgICAgIHRoaXMuY2hhbmdlQWxsQ2hlY2tlZCh0cnVlKQ0KICAgICAgICB0aGlzLmNoZWNrT3V0KCkNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRoaXMuY2hhbmdlQWxsQ2hlY2tlZChmYWxzZSkNCiAgICAgICAgdGhpcy5wcmljZSA9IDANCiAgICAgIH0NCiAgICB9LA0KDQogICAgY2hhbmdlQWxsQ2hlY2tlZChzdGF0dXMpIHsNCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5zZWxlY3RMaXN0Lmxlbmd0aDsgaSsrKSB7DQogICAgICAgIHRoaXMuc2VsZWN0TGlzdFtpXS5jaGVja2VkID0gc3RhdHVzDQogICAgICB9DQogICAgfSwNCg0KICAgIGNoZWNrT3V0KCkgew0KICAgICAgdGhpcy5wcmljZSA9IDANCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5zZWxlY3RMaXN0Lmxlbmd0aDsgaSsrKSB7DQogICAgICAgIGlmICh0aGlzLnNlbGVjdExpc3RbaV0uY2hlY2tlZCkgew0KICAgICAgICAgIHRoaXMucHJpY2UgKz0gdGhpcy5zZWxlY3RMaXN0W2ldLmNhcnQucHJpY2UNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0sDQoNCiAgICBoYW5kbGVEZWxldGUoaW5kZXgpIHsNCiAgICAgIERlbGV0ZUNhcnRCeUlkKHRoaXMuY2FydExpc3RbaW5kZXhdLmNhcnQuaWQpLnRoZW4ocmVzID0+IHsNCiAgICAgICAgY29uc29sZS5sb2cocmVzKQ0KICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsNCiAgICAgICAgICB0aGlzLmNhcnRMaXN0LnNwbGljZShpbmRleCwgMSkNCiAgICAgICAgfQ0KICAgICAgfSkNCiAgICB9LA0KDQogICAgc3VibWl0Q2FydCgpIHsNCiAgICAgIHRoaXMuJGNvbmZpcm0oJ+ivt+aCqOS7lOe7huehruiupOiuouWNlemHkemineS4uicgKyB0aGlzLnByaWNlICsgJ+WFgywg5piv5ZCm57un57utPycsICfmj5DnpLonLCB7DQogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56Gu6K6k5pSv5LuYJywNCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WPlua2iOaUr+S7mCcsDQogICAgICAgIHR5cGU6ICdzdWNjZXNzJywNCiAgICAgICAgY2VudGVyOiB0cnVlDQogICAgICB9KS50aGVuKCgpID0+IHsNCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnNlbGVjdExpc3QubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICBpZiAodGhpcy5zZWxlY3RMaXN0W2ldLmNoZWNrZWQpIHsNCiAgICAgICAgICAgIHRoaXMuc2VsZWN0TGlzdFtpXS5jYXJ0LnN0YXR1cyA9IDINCiAgICAgICAgICAgIHRoaXMuY2VudGVyRGlhbG9nVmlzaWJsZSA9IHRydWUNCiAgICAgICAgICAgIHRoaXMuaSA9IGkNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0pLmNhdGNoKCgpID0+IHsNCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnNlbGVjdExpc3QubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICBpZiAodGhpcy5zZWxlY3RMaXN0W2ldLmNoZWNrZWQpIHsNCiAgICAgICAgICAgIHRoaXMuc2VsZWN0TGlzdFtpXS5jYXJ0LnN0YXR1cyA9IDANCiAgICAgICAgICAgIENyZWF0ZU9yZGVyKHRoaXMuc2VsZWN0TGlzdFtpXS5jYXJ0KS50aGVuKHJlcyA9PiB7DQogICAgICAgICAgICAgIGlmIChyZXMuc3VjY2Vzcykgew0KICAgICAgICAgICAgICAgIERlbGV0ZUNhcnRCeUlkKHRoaXMuc2VsZWN0TGlzdFtpXS5jYXJ0LmlkKQ0KICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgICAgICAgICAgdHlwZTogJ3dhcm5pbmcnLA0KICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJ+eUqOaIt+W3suWPlua2iOaUr+S7mCwg6K+35oKo5YmN5b6A5oiR55qE6K6i5Y2V6L+b6KGM5pSv5LuYJw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIHRoaXMubG9hZENhcnRzKCkNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSkNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0pOw0KICAgIH0sDQoNCiAgICBzdWJtaXRQYXkoKSB7DQogICAgICBjb25zdCBpID0gdGhpcy5pDQogICAgICBDcmVhdGVPcmRlcih0aGlzLnNlbGVjdExpc3RbaV0uY2FydCkudGhlbihyZXMgPT4gew0KICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsNCiAgICAgICAgICB0aGlzLmNlbnRlckRpYWxvZ1Zpc2libGUgPSBmYWxzZQ0KICAgICAgICAgIERlbGV0ZUNhcnRCeUlkKHRoaXMuc2VsZWN0TGlzdFtpXS5jYXJ0LmlkKQ0KICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLA0KICAgICAgICAgICAgbWVzc2FnZTogJ+aBreWWnOS9oOaUr+S7mOaIkOWKnyEnDQogICAgICAgICAgfSk7DQogICAgICAgICAgdGhpcy5sb2FkQ2FydHMoKQ0KICAgICAgICB9DQogICAgICB9KQ0KICAgIH0sDQoNCiAgfSwNCg0KfQ0K"},{"version":3,"sources":["Cart.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4DA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA","file":"Cart.vue","sourceRoot":"src/views/me","sourcesContent":["<template>\r\n  <div style=\"width: 100%\">\r\n    <h3 style=\"letter-spacing: 1px;font-weight: 400;padding-bottom: 20px\">购物车</h3>\r\n\r\n    <div v-loading=\"loading\">\r\n\r\n      <el-card v-for=\"(item, index) in cartList\" :key=\"index\" class=\"box-card\">\r\n        <div>\r\n          <div style=\"float: left;line-height: 100px;padding-right: 20px\">\r\n            <el-checkbox @change=\"handleCheck\" v-model=\"selectList[index].checked\"></el-checkbox>\r\n          </div>\r\n          <img class=\"item-film-img\" alt=\"\" src=\"../../assets/img/film.png\"/>\r\n          <div style=\"float: left;\">\r\n            <div class=\"item-film-name\">《{{ item.film.name }}》</div>\r\n            <div class=\"item-film-seat\">座位 : {{ item.cart.seats }}</div>\r\n            <div class=\"item-film-seat\">手机号码 : {{ item.cart.phone }}</div>\r\n            <div class=\"item-film-time\">开场时间 :\r\n              <span style=\"color: red\">{{ item.arrangement.date }} - {{ item.arrangement.startTime }}</span>\r\n            </div>\r\n          </div>\r\n          <div style=\"float: right;color: #f34d41;letter-spacing: 2px; line-height: 100px;padding-right: 5px\">\r\n            ￥{{ item.cart.price }}\r\n            <el-button @click=\"handleDelete(index)\"\r\n                       type=\"text\"\r\n                       style=\"color: red;padding-left: 50px\"\r\n                       icon=\"el-icon-delete\">删除\r\n            </el-button>\r\n          </div>\r\n        </div>\r\n      </el-card>\r\n\r\n      <div v-if=\"cartList.length !==0\" style=\"height: 60px;background: #91949c\">\r\n        <div>\r\n          <div style=\"float: left;line-height: 60px;padding: 0 20px;font-size: 14px\">\r\n            <el-checkbox @change=\"handleCheckAll\" v-model=\"checkAll\">全 选</el-checkbox>\r\n          </div>\r\n          <el-button @click=\"submitCart\" type=\"text\" class=\"sub-btn\">全部结算</el-button>\r\n          <div class=\"order-footer1\">合计 : ￥{{ price }}</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <el-dialog\r\n        title=\"扫码支付\"\r\n        :show-close=\"false\"\r\n        width=\"30%\"\r\n        :visible.sync=\"centerDialogVisible\"\r\n    >\r\n      <div>\r\n        <img class=\"c-img\" src=\"../../assets/img/c.jpeg\" alt=\"\">\r\n      </div>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n    <el-button type=\"primary\" @click=\"submitPay\">支 付 成 功</el-button>\r\n  </span>\r\n    </el-dialog>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {DeleteCartById, ListCarts} from \"@/api/cart\"\r\nimport {CreateOrder} from \"@/api/order\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      i: 0,\r\n      success: false,\r\n      centerDialogVisible: false,\r\n      loading: false,\r\n      price: 0,\r\n      selectList: [],\r\n      checkAll: false,\r\n      cartList: [],\r\n      uid: localStorage.getItem(\"uid\"),\r\n    }\r\n  },\r\n\r\n  mounted() {\r\n    this.loadCarts()\r\n  },\r\n\r\n  methods: {\r\n\r\n    loadCarts() {\r\n      this.loading = true;\r\n      ListCarts(this.uid).then(res => {\r\n        setTimeout(() => {\r\n          this.cartList = res.data\r\n          for (let i = 0; i < this.cartList.length; i++) {\r\n            this.selectList[i] = {checked: false, cart: this.cartList[i].cart}\r\n          }\r\n          this.loading = false\r\n        }, 700)\r\n      })\r\n    },\r\n\r\n    handleCheck() {\r\n      this.checkOut()\r\n    },\r\n\r\n    handleCheckAll() {\r\n      if (this.checkAll) {\r\n        this.changeAllChecked(true)\r\n        this.checkOut()\r\n      } else {\r\n        this.changeAllChecked(false)\r\n        this.price = 0\r\n      }\r\n    },\r\n\r\n    changeAllChecked(status) {\r\n      for (let i = 0; i < this.selectList.length; i++) {\r\n        this.selectList[i].checked = status\r\n      }\r\n    },\r\n\r\n    checkOut() {\r\n      this.price = 0\r\n      for (let i = 0; i < this.selectList.length; i++) {\r\n        if (this.selectList[i].checked) {\r\n          this.price += this.selectList[i].cart.price\r\n        }\r\n      }\r\n    },\r\n\r\n    handleDelete(index) {\r\n      DeleteCartById(this.cartList[index].cart.id).then(res => {\r\n        console.log(res)\r\n        if (res.success) {\r\n          this.cartList.splice(index, 1)\r\n        }\r\n      })\r\n    },\r\n\r\n    submitCart() {\r\n      this.$confirm('请您仔细确认订单金额为' + this.price + '元, 是否继续?', '提示', {\r\n        confirmButtonText: '确认支付',\r\n        cancelButtonText: '取消支付',\r\n        type: 'success',\r\n        center: true\r\n      }).then(() => {\r\n        for (let i = 0; i < this.selectList.length; i++) {\r\n          if (this.selectList[i].checked) {\r\n            this.selectList[i].cart.status = 2\r\n            this.centerDialogVisible = true\r\n            this.i = i\r\n          }\r\n        }\r\n      }).catch(() => {\r\n        for (let i = 0; i < this.selectList.length; i++) {\r\n          if (this.selectList[i].checked) {\r\n            this.selectList[i].cart.status = 0\r\n            CreateOrder(this.selectList[i].cart).then(res => {\r\n              if (res.success) {\r\n                DeleteCartById(this.selectList[i].cart.id)\r\n                this.$message({\r\n                  type: 'warning',\r\n                  message: '用户已取消支付, 请您前往我的订单进行支付'\r\n                });\r\n                this.loadCarts()\r\n              }\r\n            })\r\n          }\r\n        }\r\n      });\r\n    },\r\n\r\n    submitPay() {\r\n      const i = this.i\r\n      CreateOrder(this.selectList[i].cart).then(res => {\r\n        if (res.success) {\r\n          this.centerDialogVisible = false\r\n          DeleteCartById(this.selectList[i].cart.id)\r\n          this.$message({\r\n            type: 'success',\r\n            message: '恭喜你支付成功!'\r\n          });\r\n          this.loadCarts()\r\n        }\r\n      })\r\n    },\r\n\r\n  },\r\n\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n.box-card {\r\n  margin-bottom: 5px;\r\n}\r\n\r\n>>> .el-card__header {\r\n  background: #C0C4CC;\r\n}\r\n\r\n.item-film-img {\r\n  float: left;\r\n  width: 80px;\r\n  height: 100px;\r\n  padding-bottom: 20px;\r\n  padding-right: 10px;\r\n}\r\n\r\n.item-film-name {\r\n  letter-spacing: 2px;\r\n  font-weight: 500;\r\n  font-size: 18px;\r\n  padding-bottom: 13px;\r\n}\r\n\r\n.item-film-seat {\r\n  letter-spacing: 1px;\r\n  font-size: 12px;\r\n  padding-bottom: 8px;\r\n  padding-left: 10px;\r\n  color: #91949c;\r\n}\r\n\r\n\r\n.item-film-time {\r\n  font-size: 12px;\r\n  padding-left: 10px;\r\n  letter-spacing: 1px;\r\n  color: #91949c;\r\n}\r\n\r\n.c-img {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.sub-btn {\r\n  float: right;\r\n  color: #000000;\r\n  height: 60px;\r\n  width: 120px;\r\n  background: #f34d41;\r\n  letter-spacing: 2px;\r\n  line-height: 33px;\r\n  text-align: center;\r\n  font-weight: 500;\r\n  font-size: 18px;\r\n}\r\n\r\n.order-footer1 {\r\n  float: right;\r\n  line-height: 60px;\r\n  padding-right: 40px;\r\n}\r\n\r\na {\r\n  color: #333333;\r\n}\r\n\r\n.di {\r\n  text-align: center;\r\n  font-size: 20px;\r\n  letter-spacing: 3px;\r\n  font-weight: bold;\r\n  padding-top: 10px;\r\n}\r\n</style>"]}]}